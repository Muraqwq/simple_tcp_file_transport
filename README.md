# High-Performance Custom TCP Protocol

è¿™æ˜¯ä¸€ä¸ªåŸºäº UDP å®ç°çš„é«˜æ€§èƒ½å¯é æ–‡ä»¶ä¼ è¾“åè®® (Custom TCP)ï¼Œä½œä¸ºè®¡ç®—æœºç½‘ç»œè¯¾ç¨‹çš„å¤§ä½œä¸šé¡¹ç›®ã€‚

æœ¬é¡¹ç›®åœ¨åº”ç”¨å±‚å®ç°äº†ç±»ä¼¼ TCP çš„æ ¸å¿ƒç‰¹æ€§ï¼Œç›¸æ¯”åŸºç¡€çš„ Stop-and-Wait åè®®ï¼Œé€šè¿‡å¼•å…¥**æ»‘åŠ¨çª—å£**å’Œ**å¿«é‡ä¼ **ç­‰æœºåˆ¶ï¼Œå°†ä¼ è¾“ååé‡æå‡äº† **70 å€**ä»¥ä¸Šï¼ˆåœ¨ Localhost ä¸‹å®æµ‹è¾¾åˆ° 25MB/s+ï¼‰ã€‚

## ğŸš€ ä¸»è¦ç‰¹æ€§ (Features)

*   **å¯é ä¼ è¾“ (Reliability)**: åŸºäº ACK ç¡®è®¤æœºåˆ¶ï¼Œä¿è¯æ•°æ®ä¸ä¸¢ã€ä¸ä¹±ã€‚
*   **æµæ°´çº¿ (Pipelining)**: å®ç°**æ»‘åŠ¨çª—å£ (Sliding Window)**ï¼Œæ”¯æŒå¤šåŒ…å¹¶å‘ä¼ è¾“ã€‚
*   **æµé‡æ§åˆ¶ (Flow Control)**: å®ç°äº†åŸºäºæ¥æ”¶çª—å£ (`rwnd`) çš„æµé‡æ§åˆ¶ï¼Œé˜²æ­¢å‘é€æ–¹æ·¹æ²¡æ¥æ”¶æ–¹ã€‚
*   **æ‹¥å¡æ§åˆ¶ä¼˜åŒ–**: å®ç°äº† **å¿«é‡ä¼  (Fast Retransmit)**ï¼Œåœ¨æ£€æµ‹åˆ° 3 ä¸ªé‡å¤ ACK æ—¶ç«‹å³é‡ä¼ ï¼Œæ— éœ€ç­‰å¾…è¶…æ—¶ã€‚
*   **åº”ç”¨å±‚åŠŸèƒ½**: æ”¯æŒåŒå‘æ–‡ä»¶ä¼ è¾“ (Upload / Download)ã€‚
*   **é«˜æ€§èƒ½**:
    *   ä½¿ç”¨ 32 ä½é€šå‘Šçª—å£ (è§£å†³äº† 64KB é™åˆ¶)ã€‚
    *   ä½¿ç”¨ `std::deque` ä¼˜åŒ–æ¥æ”¶ç¼“å†² (O(1) å¤´éƒ¨åˆ é™¤)ã€‚
    *   ç¹å¿™å¾ªç¯ä¸­åŠ å…¥ `Yield` é™ä½ CPU å ç”¨ã€‚

## ğŸ“‚ é¡¹ç›®æ–‡æ¡£ (Docs)

è¯¦ç»†çš„è®¾è®¡æ–‡æ¡£å’Œæµ‹è¯•æŠ¥å‘Šè¯·è§ `doc/` ç›®å½•ï¼š
*   [Technical Design](doc/technical_design.md): ç³»ç»Ÿè¯¦ç»†æ¶æ„ä¸çŠ¶æ€æœºè®¾è®¡ã€‚
*   [Performance Report](doc/report_phase4_performance.md): åœæ­¢ç­‰å¾… vs æ»‘åŠ¨çª—å£çš„æ€§èƒ½å¯¹æ¯”æŠ¥å‘Šã€‚
*   [Project Task](doc/task.md): å¼€å‘è¿›åº¦ä¸ä»»åŠ¡è§„åˆ’ã€‚

## ğŸ› ï¸ ç¼–è¯‘ä¸è¿è¡Œ (Build & Run)

### ç¯å¢ƒè¦æ±‚
*   C++17 Compiler (GCC/Clang)
*   CMake >= 3.10
*   Mac/Linux (Windows ç§»æ¤ä¸­)

### ç¼–è¯‘
```bash
mkdir build
cd build
cmake ..
make
```

### è¿è¡Œ
ç¨‹åºç¼–è¯‘åç”Ÿæˆ `tcp_app` å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**1. å¯åŠ¨æœåŠ¡å™¨:**
```bash
./tcp_app server <port>
# ç¤ºä¾‹
./tcp_app server 8080
```

**2. å¯åŠ¨å®¢æˆ·ç«¯:**
```bash
./tcp_app client <server_ip> <server_port>
# ç¤ºä¾‹
./tcp_app client 127.0.0.1 8080
```

**3. æ‰§è¡Œå‘½ä»¤ (åœ¨å®¢æˆ·ç«¯ä¸­):**
è¿æ¥æˆåŠŸåï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

*   **ä¸Šä¼ æ–‡ä»¶**:
    ```text
    > upload test_file.data
    ```
*   **ä¸‹è½½æ–‡ä»¶**:
    ```text
    > download server_file.data
    ```
*   **é€€å‡º**:
    ```text
    > exit
    ```

## ğŸ“Š æ€§èƒ½æ•°æ®

| æ–‡ä»¶å¤§å° | è€—æ—¶ (s) | é€Ÿåº¦ | å¤‡æ³¨ |
| :--- | :--- | :--- | :--- |
| **50 MB** | 1.99 | ~25.7 MB/s | ç¨³å®š |
| **1 GB** | 41.6 | ~25.2 MB/s | é•¿æ—¶ç¨³å®š |

*(æ•°æ®åŸºäº MacOS Localhost æµ‹è¯•)*
